<!DOCTYPE html>
<html ⚡>
<head>
    <meta charset="utf-8">

    <title>Qué es un sparse file</title>

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">

    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="canonical" href="https://manuelviera.com/blog/que-es-un-sparse-file/" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    
    <meta property="og:site_name" content="Manuel Viera" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Qué es un sparse file" />
    <meta property="og:description" content="Hoy me he encontrado con el término sparse file y realmente no lo conocía, aunque puede que os pase como a mi, que después de que os diga qué es, muchos de vosotros ya sabíais de su existencia e incluso es muy probable que hayáis trabajado con este tipo de" />
    <meta property="og:url" content="https://manuelviera.com/blog/que-es-un-sparse-file/" />
    <meta property="article:published_time" content="2013-01-17T10:00:00.000Z" />
    <meta property="article:modified_time" content="2020-06-14T12:48:47.000Z" />
    <meta property="article:tag" content="tech" />
    
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Qué es un sparse file" />
    <meta name="twitter:description" content="Hoy me he encontrado con el término sparse file y realmente no lo conocía, aunque puede que os pase como a mi, que después de que os diga qué es, muchos de vosotros ya sabíais de su existencia e incluso es muy probable que hayáis trabajado con este tipo de" />
    <meta name="twitter:url" content="https://manuelviera.com/blog/que-es-un-sparse-file/" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Manuel Viera" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="tech" />
    <meta name="twitter:site" content="@mviera" />
    <meta name="twitter:creator" content="@mviera" />
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Manuel Viera",
        "url": "https://manuelviera.com/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://manuelviera.com/favicon.ico",
            "width": 48,
            "height": 48
        }
    },
    "author": {
        "@type": "Person",
        "name": "Manuel Viera",
        "image": {
            "@type": "ImageObject",
            "url": "https://manuelviera.com/content/images/2020/06/2020-06-22-161222_428x430_scrot.png",
            "width": 428,
            "height": 430
        },
        "url": "https://manuelviera.com/author/mviera/",
        "sameAs": [
            "https://manuelviera.com",
            "https://twitter.com/mviera"
        ]
    },
    "headline": "Qué es un sparse file",
    "url": "https://manuelviera.com/blog/que-es-un-sparse-file/",
    "datePublished": "2013-01-17T10:00:00.000Z",
    "dateModified": "2020-06-14T12:48:47.000Z",
    "keywords": "tech",
    "description": "Hoy me he encontrado con el término sparse file y realmente no lo conocía,\naunque puede que os pase como a mi, que después de que os diga qué es, muchos de\nvosotros ya sabíais de su existencia e incluso es muy probable que hayáis\ntrabajado con este tipo de ficheros. Pero...\n\n¿Qué es un sparse file?\nUn sparse file es un tipo de fichero el cual se crea con un tamaño específico\npero no se reserva dicho espacio en el sistema de ficheros inicialmente. Su\ntamaño irá creciendo a medida que vaya siendo ",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://manuelviera.com/"
    }
}
    </script>

    <meta name="generator" content="Ghost 3.19" />
    <link rel="alternate" type="application/rss+xml" title="Manuel Viera" href="https://manuelviera.com/blog/rss/" />

    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,600,400" />
    <style amp-custom>html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block;vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background-color:transparent}a:active,a:hover{outline:0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:bold}dfn{font-style:italic}h1{margin:0.67em 0;font-size:2em}mark{background:#ff0;color:#000}small{font-size:80%}sub,sup{position:relative;vertical-align:baseline;font-size:75%;line-height:0}sup{top:-0.5em}sub{bottom:-0.25em}img{border:0}amp-img{border:0}svg:not(:root){overflow:hidden}figure{margin:1em 40px}hr{box-sizing:content-box;height:0}pre{overflow:auto}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}button,input,optgroup,select,textarea{margin:0;color:inherit;font:inherit}button{overflow:visible}button,select{text-transform:none}button,html input[type="button"],input[type="reset"],input[type="submit"]{cursor:pointer;-webkit-appearance:button}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{padding:0;border:0}input{line-height:normal}input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}input[type="number"]::-webkit-inner-spin-button,input[type="number"]::-webkit-outer-spin-button{height:auto}input[type="search"]{-webkit-appearance:textfield}input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}fieldset{margin:0 2px;padding:0.35em 0.625em 0.75em;border:1px solid #c0c0c0}legend{padding:0;border:0}textarea{overflow:auto}optgroup{font-weight:bold}table{border-spacing:0;border-collapse:collapse}td,th{padding:0}html{max-height:100%;height:100%;font-size:62.5%;-webkit-tap-highlight-color:rgba(0,0,0,0)}body{max-height:100%;height:100%;color:#3a4145;background:#f4f8fb;letter-spacing:0.01rem;font-family:"Merriweather",serif;font-size:1.8rem;line-height:1.75em;text-rendering:geometricPrecision;-webkit-font-feature-settings:"kern" 1;-moz-font-feature-settings:"kern" 1;-o-font-feature-settings:"kern" 1}::-moz-selection{background:#d6edff}::selection{background:#d6edff}h1,h2,h3,h4,h5,h6{margin:0 0 0.3em 0;color:#2e2e2e;font-family:"Open Sans",sans-serif;line-height:1.15em;text-rendering:geometricPrecision;-webkit-font-feature-settings:"dlig" 1,"liga" 1,"lnum" 1,"kern" 1;-moz-font-feature-settings:"dlig" 1,"liga" 1,"lnum" 1,"kern" 1;-o-font-feature-settings:"dlig" 1,"liga" 1,"lnum" 1,"kern" 1}h1{text-indent:-2px;letter-spacing:-1px;font-size:2.6rem}h2{letter-spacing:0;font-size:2.4rem}h3{letter-spacing:-0.6px;font-size:2.1rem}h4{font-size:1.9rem}h5{font-size:1.8rem}h6{font-size:1.8rem}a{color:#4a4a4a}a:hover{color:#111}p,ul,ol,dl{margin:0 0 2.5rem 0;font-size:1.5rem;text-rendering:geometricPrecision;-webkit-font-feature-settings:"liga" 1,"onum" 1,"kern" 1;-moz-font-feature-settings:"liga" 1,"onum" 1,"kern" 1;-o-font-feature-settings:"liga" 1,"onum" 1,"kern" 1}ol,ul{padding-left:2em}ol ol,ul ul,ul ol,ol ul{margin:0 0 0.4em 0;padding-left:2em}dl dt{float:left;clear:left;overflow:hidden;margin-bottom:1em;width:180px;text-align:right;text-overflow:ellipsis;white-space:nowrap;font-weight:700}dl dd{margin-bottom:1em;margin-left:200px}li{margin:0.4em 0}li li{margin:0}hr{display:block;margin:1.75em 0;padding:0;height:1px;border:0;border-top:#efefef 1px solid}blockquote{box-sizing:border-box;margin:1.75em 0 1.75em 0;padding:0 0 0 1.75em;border-left:#4a4a4a 0.4em solid;-moz-box-sizing:border-box}blockquote p{margin:0.8em 0;font-style:italic}blockquote small{display:inline-block;margin:0.8em 0 0.8em 1.5em;color:#ccc;font-size:0.9em}blockquote small:before{content:"\2014 \00A0"}blockquote cite{font-weight:700}blockquote cite a{font-weight:normal}mark{background-color:#fdffb6}code,tt{padding:1px 3px;border:#e3edf3 1px solid;background:#f7fafb;border-radius:2px;white-space:pre-wrap;font-family:Inconsolata,monospace,sans-serif;font-size:0.85em;font-feature-settings:"liga" 0;-webkit-font-feature-settings:"liga" 0;-moz-font-feature-settings:"liga" 0}pre{overflow:auto;box-sizing:border-box;margin:0 0 1.75em 0;padding:10px;width:100%;border:#e3edf3 1px solid;background:#f7fafb;border-radius:3px;white-space:pre;font-family:Inconsolata,monospace,sans-serif;font-size:0.9em;-moz-box-sizing:border-box}pre code,pre tt{padding:0;border:none;background:transparent;white-space:pre-wrap;font-size:inherit}kbd{display:inline-block;margin-bottom:0.4em;padding:1px 8px;border:#ccc 1px solid;background:#f4f4f4;border-radius:4px;box-shadow:0 1px 0 rgba(0,0,0,0.2),0 1px 0 0 #fff inset;color:#666;text-shadow:#fff 0 1px 0;font-size:0.9em;font-weight:700}table{box-sizing:border-box;margin:1.75em 0;max-width:100%;width:100%;background-color:transparent;-moz-box-sizing:border-box}table th,table td{padding:8px;border-top:#efefef 1px solid;vertical-align:top;text-align:left;line-height:20px}table th{color:#000}table caption + thead tr:first-child th,table caption + thead tr:first-child td,table colgroup + thead tr:first-child th,table colgroup + thead tr:first-child td,table thead:first-child tr:first-child th,table thead:first-child tr:first-child td{border-top:0}table tbody + tbody{border-top:#efefef 2px solid}table table table{background-color:#fff}table tbody > tr:nth-child(odd) > td,table tbody > tr:nth-child(odd) > th{background-color:#f6f6f6}table.plain tbody > tr:nth-child(odd) > td,table.plain tbody > tr:nth-child(odd) > th{background:transparent}iframe,amp-iframe,.fluid-width-video-wrapper{display:block;margin:1.75em 0}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper amp-iframe{margin:0}textarea,select,input{margin:0 0 5px 0;padding:6px 9px;width:260px;outline:0;border:#e7eef2 1px solid;background:#fff;border-radius:4px;box-shadow:none;font-family:"Open Sans",sans-serif;font-size:1.6rem;line-height:1.4em;font-weight:100;-webkit-appearance:none}textarea{min-width:250px;min-height:80px;max-width:340px;width:100%;height:auto}input[type="text"]:focus,input[type="email"]:focus,input[type="search"]:focus,input[type="tel"]:focus,input[type="url"]:focus,input[type="password"]:focus,input[type="number"]:focus,input[type="date"]:focus,input[type="month"]:focus,input[type="week"]:focus,input[type="time"]:focus,input[type="datetime"]:focus,input[type="datetime-local"]:focus,textarea:focus{outline:none;outline-width:0;border:#bbc7cc 1px solid;background:#fff}select{width:270px;height:30px;line-height:30px}.clearfix:before,.clearfix:after{content:" ";display:table}.clearfix:after{clear:both}.clearfix{zoom:1}.main-header{position:relative;display:table;overflow:hidden;box-sizing:border-box;width:100%;height:50px;background:#5ba4e5 no-repeat center center;background-size:cover;text-align:left;-webkit-box-sizing:border-box;-moz-box-sizing:border-box}.content{background:#fff;padding-top:15px}.blog-title,.content{margin:auto;max-width:600px}.blog-title a{display:block;padding-right:16px;padding-left:16px;height:50px;color:#fff;text-decoration:none;font-family:"Open Sans",sans-serif;font-size:16px;line-height:50px;font-weight:600}.post{position:relative;margin-top:0;margin-right:16px;margin-left:16px;padding-bottom:0;max-width:100%;border-bottom:#ebf2f6 1px solid;word-wrap:break-word;font-size:0.95em;line-height:1.65em}.post-header{margin-bottom:1rem}.post-title{margin-bottom:0}.post-title a{text-decoration:none}.post-meta{display:block;margin:3px 0 0 0;color:#9eabb3;font-family:"Open Sans",sans-serif;font-size:1.3rem;line-height:2.2rem}.post-meta a{color:#9eabb3;text-decoration:none}.post-meta a:hover{text-decoration:underline}.post-meta .author{margin:0;font-size:1.3rem;line-height:1.3em}.post-date{display:inline-block;text-transform:uppercase;white-space:nowrap;font-size:1.2rem;line-height:1.2em}.post-image{margin:0;padding-top:3rem;padding-bottom:30px;border-top:1px #E8E8E8 solid}.post-image img{object-fit:cover;}.post-content amp-img,.post-content amp-anim{position:relative;left:50%;display:block;padding:0;min-width:0;max-width:112%;width:calc(100% + 32px);height:auto;transform:translateX(-50%);-webkit-transform:translateX(-50%);-ms-transform:translateX(-50%)}.footnotes{font-size:1.3rem;line-height:1.6em;font-style:italic}.footnotes li{margin:0.6rem 0}.footnotes p{margin:0}.footnotes p a:last-child{text-decoration:none}.site-footer{position:relative;margin:0 auto 20px auto;padding:1rem 15px;max-width:600px;color:rgba(0,0,0,0.5);font-family:"Open Sans",sans-serif;font-size:1.1rem;line-height:1.75em}.site-footer a{color:rgba(0,0,0,0.5);text-decoration:none;font-weight:bold}.site-footer a:hover{border-bottom:#bbc7cc 1px solid}.poweredby{display:block;float:right;width:45%;text-align:right}.copyright{display:block;float:left;width:45%}</style>

    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <script async src="https://cdn.ampproject.org/v0.js"></script>

    

</head>

<body class="amp-template">
    <header class="main-header">
        <nav class="blog-title">
            <a href="https://manuelviera.com">Manuel Viera</a>
        </nav>
    </header>

    <main class="content" role="main">
        <article class="post">

            <header class="post-header">
                <h1 class="post-title">Qué es un sparse file</h1>
                <section class="post-meta">
                    <p class="author">by <a href="/author/mviera/">Manuel Viera</a></p>
                    <time class="post-date" datetime="2013-01-17">2013-01-17</time>
                </section>
            </header>
            <section class="post-content">

                <p>Hoy me he encontrado con el término <em>sparse file</em> y realmente no lo conocía, aunque puede que os pase como a mi, que después de que os diga qué es, muchos de vosotros ya sabíais de su existencia e incluso es muy probable que hayáis trabajado con este tipo de ficheros. Pero...</p>
<h2 id="quesunsparsefile">¿Qué es un <em>sparse file</em>?</h2>
<p>Un <em>sparse file</em> es un tipo de fichero el cual se crea con un tamaño específico pero no se reserva dicho espacio en el sistema de ficheros inicialmente. Su tamaño irá creciendo a medida que vaya siendo necesario. Por ejemplo, podríamos crear un fichero cuyo tamaño máximo sea 2G pero que inicialmente en nuestro sistema de ficheros ocupe 0 bytes.</p>
<p>Es muy probable que ya es sea más familiar este tipo de ficheros, sobre todo aquellos que hayáis trabajado con virtualización, por ejemplo con KVM<br />
utilizando virt-manager, cuando al crear un volumen de almacenamiento para una máquina virtual ofrece la opción de alojar la totalidad del volumen en el pool de almacenamiento, o que el tamaño del volumen vaya creciendo dinámicamente.</p>
<p>Para temas de virtualización <strong>no</strong> es aconsejable utilizar este tipo de<br />
ficheros porque pueden generar problemas de rendimiento e integridad de los<br />
datos. De todas formas, son bastante útiles para realizar pruebas.</p>
<h2 id="quventajasmeaporta">¿Qué ventajas me aporta?</h2>
<p>Como ventajas puntualizaría la rapidez con la que son creados, que como he<br />
comentado anteriormente, para realizar pruebas son perfectos, ya que<br />
inicialmente "no ocupan" espacio en el sistema.</p>
<p>Además utilizar un <em>sparse file</em> nos permitirá crear un fichero de gran tamaño aunque en ese momento no dispongamos de tal espacio en nuestro sistema de ficheros.</p>
<h2 id="peronoesorotodoloquereluce">Pero no es oro todo lo que reluce...</h2>
<p>Este tipo de fichero es soportado en la mayoría de los sistemas de ficheros<br />
modernos en Unix, incluso en NTFS; pero al parecer no es posible, y lo he<br />
comprobado, en HFS+ de Apple.</p>
<p>A parte de los problemas de rendimiento e integridad con los datos comentados anteriormente, es posible que obtengamos resultados inesperados cuando tratemos de copiar este tipo de ficheros, pues si la utilidad que hemos usado para copiarlo no soporta este tipo de ficheros, será copiado con el tamaño completo.</p>
<p>Afortunadamente <em>cp</em>, por defecto, y <em>rsync</em> con la opción <strong>-S</strong> /<br />
<strong>--sparse</strong>, soportan este tipo de ficheros.</p>
<h2 id="ycmocreounsparsefile">¿Y cómo creo un <em>sparse file</em>?</h2>
<p>La creación de un <em>sparse file</em> es muy sencillo, es posible hacerlo con el<br />
comando <em>dd</em> que muchos ya conoceréis al haber creado ficheros llenos de ceros de la siguiente forma:</p>
<pre><code>$ dd if=/dev/zero of=file.img bs=1M count=1G
</code></pre>
<p>Esta instrucción creará un fichero lleno de ceros ocupando 1G de espacio en<br />
vuestro sistema de ficheros.</p>
<p>Pero para crear un <em>sparse file</em> será necesario ejecutar la siguiente<br />
instrucción, similar a la anterior:</p>
<pre><code>$ dd if=/dev/zero of=file.img bs=1M count=0 seek=1024
0+0 registros leídos
0+0 registros escritos
0 bytes (0 B) copiados, 1,802e-05 s, 0,0 kB/s
</code></pre>
<p>El truco se encuentra en el operador <strong>seek</strong>. En este caso tendremos un<br />
fichero que inicialmente ocupa 0 bytes pero con un tamaño de 1G en potencia.</p>
<pre><code>$ du -hs file.img 
0   file.img
</code></pre>
<p>Sin embargo, podemos ver su tamaño real con la opción <strong>--apparent-size</strong> de la siguiente forma:</p>
<pre><code>$ du -h --apparent-size file.img
1,0G    file.img
</code></pre>
<h2 id="perocmocomprueboquesutamaocrecedinmicamente">¿Pero cómo compruebo que su tamaño crece dinámicamente?</h2>
<p>Es muy sencillo, crearemos ficheros dentro de este y veremos cómo aumenta de tamaño dinámicamente hasta un total de 1G. Para ello seguiremos los siguiente pasos:</p>
<ol>
<li>
<p>Crearemos un sistema de ficheros en <em>file.img</em>, lo cual nos va a permitir alojar ficheros dentro de él convirtiéndolo en un volumen de almacenamiento:</p>
<pre><code>   $ mkfs.ext4 -q file.img  
   file.img no es un dispositivo especial de bloques.
   ¿Continuar de todas formas? (s,n) s
</code></pre>
</li>
<li>
<p>Montamos el fichero como si de un dispositivo de almacenamiento se<br />
tratase, utilizando el comando <em>mount</em>, de la siguiente forma:</p>
<pre><code>   $ mkdir mnt
   $ sudo mount -t auto file.img mnt
</code></pre>
</li>
</ol>
<p>Si listamos los puntos de montaje actuales en nuestro sistema, deberíamos ver el fichero <em>file.img</em> montado en el directorio local <em>mnt</em>:</p>
<pre><code>    $ mount |grep file.img
    /tmp/file.img on /tmp/mnt type ext4 (rw)
</code></pre>
<ol start="3">
<li>
<p>Creamos varios ficheros temporales dentro del punto de montaje:</p>
<pre><code>   $ for i in {1..10};do mktemp --tmpdir=mnt; done
</code></pre>
</li>
</ol>
<p><strong>Nota:</strong> aprovecho para enseñar el comando <em>mktemp</em> crea un fichero temporal del tipo <em>tmp.XXXXXXXX</em> en el directorio actual. Con la opción <em>--tmpdir</em> es posible indicar el directorio destino donde se creará el fichero temporal.</p>
<ol start="4">
<li>
<p>Comprobamos que el tamaño del fichero ha crecido con respecto al estado anterior:</p>
<pre><code>   $ du -h file.img 
   49M    file.img
</code></pre>
</li>
</ol>
<p>Y obviamente el tamaño total sigue siendo 1G:</p>
<pre><code>    $ du -h --apparent-size file.img 
    1,0G    file.img
</code></pre>
<h2 id="dndeestellmite">Dónde está el límite</h2>
<p>Lo único que nos falta comprobar es dónde está el limite. En el ejemplo<br />
utilizado es 1G, así que intentaremos crear un fichero de un tamaño mayor que el total del <em>sparse file</em>.</p>
<p>Teniendo montado el fichero en el directorio <em>mnt</em>, crearemos un fichero de 2G dentro de este, ejecutando lo siguiente:</p>
<pre><code>$ dd if=/dev/zero of=file bs=1M count=2048
dd: escribiendo «file»: No queda espacio en el dispositivo
924+0 registros leídos
923+0 registros escritos
968290304 bytes (968 MB) copiados, 4,71871 s, 205 MB/s
</code></pre>
<p>Como podemos observar, nos ha avisado de que no queda espacio libre en el<br />
dispositivo y si comprobamos el tamaño actual del fichero obtendremos lo<br />
siguiente:</p>
<pre><code>$ du -h file.img 
973M    file.img
</code></pre>
<p><strong>Nota:</strong> Hay un resto de espacio de 27M que es posible que sea debido a la<br />
reserva del 5% de espacio para el usuario root. Siempre hay una reserva de<br />
espacio para el usuario root, por defecto del 5%, de forma que este pueda<br />
acceder al dispositivo cuando haya alcanzado su límite de espacio. Si<br />
eliminamos dicha reserva, <strong>para nada recomendable en producción</strong> pero en este caso estamos probando en un fichero local, podremos comprobar que si volvemos a crear el fichero de 2G dentro del <em>sparse file</em>, el espacio llega a ocuparse completamente:</p>
<pre><code>$ tune2fs -m 0 file.img 
tune2fs 1.41.14 (22-Dec-2010)
Setting reserved blocks percentage to 0% (0 blocks)

$ dd if=/dev/zero of=file bs=1M count=2048
dd: escribiendo «file»: No queda espacio en el dispositivo
965+0 registros leídos
964+0 registros escritos
1011208192 bytes (1,0 GB) copiados, 3,27181 s, 309 MB/s

$ du -h file.img  
1,0G    file.img
</code></pre>
<h2 id="actualizacinysiqueremosaumentarellmite">Actualización: ¿Y si queremos aumentar el límite?</h2>
<p>Ayer se me debió pasar esta cuestión mientras me centraba en escribir, pero sí, es posible aumentar el tamaño del <em>sparse file</em>, ¿pero cómo?</p>
<p>Pues muy sencillo, solo tenemos que volver a utilizar el comando <em>dd</em> indicando un tamaño mayor en el parámetro <em>seek</em>, como indico a continuación:</p>
<pre><code>$ dd if=/dev/zero of=file.img bs=1M count=0 seek=2048
0+0 registros leídos
0+0 registros escritos
0 bytes (0 B) copiados, 1,6064e-05 s, 0,0 kB/s
</code></pre>
<p>Si comprobamos ahora el tamaño del fichero, podremos observar que su tamaño<br />
total a aumentado en 1G:</p>
<pre><code>$ du -h --apparent-size file.img 
2,0G    file.img
</code></pre>
<p>Pero aun no hemos terminado, sólo nos falta <strong>redimensionar</strong> el sistema de<br />
ficheros incluido en él, y esto lo haremos haciendo uso del comando <em>resize2fs</em>, pero primero realizaremos un chequeo del sistema de ficheros:</p>
<pre><code>e2fsck -f file.img 
e2fsck 1.41.14 (22-Dec-2010)
Paso 1: Verificando nodos-i, bloques y tamaños
Paso 2: Verificando la estructura de directorios
Paso 3: Revisando la conectividad de directorios
Paso 4: Revisando las cuentas de referencia
Paso 5: Revisando el resumen de información de grupos
file.img: 22/65536 ficheros (0.0% no contiguos), 259513/262144 bloques

$ resize2fs file.img 
resize2fs 1.41.14 (22-Dec-2010)
Resizing the filesystem on file.img to 524288 (4k) blocks.
El sistema de ficheros en file.img tiene ahora 524288 bloques.
</code></pre>
<p>Por último, si comprobamos el total de espacio disponible dentro del <em>sparse file</em> podremos observar que a aumentado a 2G:</p>
<pre><code>$ df -h mnt 
S.ficheros     Tamaño Usado  Disp Uso% Montado en
/dev/loop0       2,0G  998M  998M  51% /tmp/mnt
</code></pre>
<p>Espero que os haya parecido interesante! No dudéis en comentar!</p>
<p>Un saludo, Manu.</p>


            </section>

        </article>
    </main>
    <footer class="site-footer clearfix">
        <section class="copyright"><a href="https://manuelviera.com">Manuel Viera</a> &copy; 2021</section>
        <section class="poweredby">Proudly published with <a href="https://ghost.org">Ghost</a></section>
    </footer>
</body>
</html>
